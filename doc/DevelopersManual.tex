% Use the OpenCTM TeX style
\input{openctm-tex.sty}

% Document properties
\author{Marcus Geelnard}
\title{OpenCTM Developers Manual}

% Document contents
\begin{document}

%--[ Title pages ]--------------------------------------------------------------

\maketitle

\tableofcontents


%-------------------------------------------------------------------------------

\chapter{Introduction}
The OpenCTM file format is an open format for storing 3D triangle meshes.
One of the main advantages over other similar file formats is its ability
to losslessly compress the triangle geometry to a fraction of the corresponding
raw data size.

This document describes how to use the OpenCTM API to load and save OpenCTM
format files. It is mostly written for C/C++ users, but should be useful for
other programming languages too, since the concepts and function calls are
virtually identical regardless of programming language.


%-------------------------------------------------------------------------------

\chapter{Concepts}

\section{The OpenCTM API}
The OpenCTM API makes it easy to read and write OpenCTM format files. The API is
implemented in the form of a software library that an application can be linked
to in order to access the OpenCTM API.

The software library itself is written in standard, portable C language, but
can be used from many other programming languages (writing language bindings
for new languages should be fairly straight forward, since the API was written
with cross-language portability in mind).

The full documentation of the OpenCTM API can be found in the Doxygen-generated
documentation, which describes all API functions, types, constants etc.


\section{The OpenCTM context}
Bla-bla-bla...


\section{The triangle mesh}
Bla-bla-bla...



%-------------------------------------------------------------------------------

\chapter{Building from source}
To use the OpenCTM API, you need the shared library and language bindings
for loading and calling it. It can either be downloaded as a precompiled binary
package for your platform, or you can build it from the source package.

This chapter describes how to build the OpenCTM shared library from the source
package.

\section{Windows - MS Visual Studio}
Start an MS Visual Studio command line (for instance using the Tools $>$
Visual Studio 2008 Command Prompt menu from the IDE), and do the following:

\begin{lstlisting}
> cd [sourcedir]
> nmake /fMakefile.msvc
\end{lstlisting}

...where [sourcedir] is the location of the OpenCTM source. This should produce
the files openctm.dll, openctm.lib, tools\textbackslash ctmconv.exe and
tools\textbackslash ctmviewer.exe (the latter requires GLUT).


\section{Windows - MinGW32}
Start a command prompt, and do the following:

\begin{lstlisting}
> cd [sourcedir]
> mingw32-make -f Makefile.mgw
\end{lstlisting}

...where [sourcedir] is the location of the OpenCTM source. This should produce
the files openctm.dll, libopenctm.a, tools\textbackslash ctmconv.exe and
tools\textbackslash ctmviewer.exe (the latter requires GLUT).


\section{Mac OS X}
Start a shell, and do the following:

\begin{lstlisting}
> cd [sourcedir]
> make -f Makefile.macosx
\end{lstlisting}

...where [sourcedir] is the location of the OpenCTM source. This should produce
the files openctm.dylib, tools/ctmconv and tools/ctmviewer.


\section{Linux}
Start a shell, and do the following:

\begin{lstlisting}
> cd [sourcedir]
> make -f Makefile.linux
\end{lstlisting}

...where [sourcedir] is the location of the OpenCTM source. This should produce
the files libopenctm.so, tools/ctmconv and tools/ctmviewer (the latter requires
GLUT or freeglut).



%-------------------------------------------------------------------------------

\chapter{Usage}

\section{Prerequisites}
To use the OpenCTM API, you need to include the OpenCTM include file, like this:

\begin{lstlisting}
#include <openctm.h>
\end{lstlisting}

You also need to link with the OpenCTM import library. For instance, in MS
Visual Studio you can add "openctm.lib" to your Additional Dependencies field
in the Linker section. For gcc/g++ or similar compilers, you will typically
add -lopenctm to the list of compiler options, for instance:

\begin{lstlisting}
> g++ -o foo foo.cpp -lopenctm
\end{lstlisting}


\section{Loading OpenCTM files}
Below is a minimal example of how to load an OpenCTM file with the OpenCTM API,
in just a few lines of code:

\begin{lstlisting}
CTMcontext context;
CTMuint vertCount, triCount, * indices;
CTMfloat * vertices;

// Create a new context
context = ctmNewContext(CTM_IMPORT);

// Load the OpenCTM file
ctmLoad(context, "mymesh.ctm");
if(ctmGetError(context) == CTM_NONE)
{
  // Access the mesh data
  vertCount = ctmGetInteger(context, CTM_VERTEX_COUNT);
  vertices = ctmGetFloatArray(context, CTM_VERTICES);
  triCount = ctmGetInteger(context, CTM_TRIANGLE_COUNT);
  indices = ctmGetIntegerArray(context, CTM_INDICES);

  // Deal with the mesh (e.g. transcode it to our
  // internal representation)
  // ...
}

// Free the context (this frees all memory allocated by
// the OpenCTM context)
ctmFreeContext(context);
\end{lstlisting}



%-------------------------------------------------------------------------------

\chapter{C++ extensions}
To better take advantage of some of the C++ language features, such as
exception handling, a few C++ wrapper classes is availbale through the standard
API when compiling a C++ program. As usual, just include "openctm.h", and you
will have access to two new classes: CTMimporer and CTMexporter.


\section{The CTMimporter class}
Bla-bla-bla...


\section{The CTMexporter class}
Bla-bla-bla...


\end{document}
